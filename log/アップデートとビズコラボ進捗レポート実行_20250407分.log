==================================================== 
[2025/04/08 18:55:48.59] [INFO] アップデートとビズコラボ_日次処理 開始 
---------------------------------------------------- 
[2025/04/08 18:55:48.59] [INFO] 実行ディレクトリ: D:\rep05\Pythonエンベッダブル検証環境\アップデートとビズコラボ_進捗Report 
[2025/04/08 18:55:48.59] [INFO] 使用するPython: D:\rep05\Pythonエンベッダブル検証環境\Python実行環境\python.exe 
==================================================== 
Python 3.13.2
--------------------------------------- 
[STEP 01] 日時レポート計測値(famとマイム)取得と各ID進捗表に反映 
--------------------------------------- 
[DEBUG] 自動生成された table_config:
  101210: {'report_col': '101210', 'start_cell': 'I3', 'row_range': (128, 173)}
  101213: {'report_col': '101213', 'start_cell': 'P3', 'row_range': (128, 173)}
  104358: {'report_col': '104358', 'start_cell': 'W3', 'row_range': (128, 173)}
  104826: {'report_col': '104826', 'start_cell': 'AD3', 'row_range': (128, 173)}
[INFO] 処理中 → ID: 101210
[DEBUG] fam8取得 - K115 = '149,327'
[DEBUG] mime取得 - L115 = '134,176'
[DEBUG] 補填判定取得 - N115 = '10.15%'
[INFO] 処理中 → ID: 101213
[DEBUG] fam8取得 - AC115 = '92,079'
[DEBUG] mime取得 - AD115 = '90,393'
[DEBUG] 補填判定取得 - AF115 = '1.83%'
[INFO] 処理中 → ID: 104358
[DEBUG] fam8取得 - DI115 = '35,200'
[DEBUG] mime取得 - DJ115 = '34854'
[DEBUG] 補填判定取得 - DL115 = '0.98%'
[INFO] 処理中 → ID: 104826
[DEBUG] fam8取得 - DO115 = '11,753'
[DEBUG] mime取得 - DP115 = '11599'
[DEBUG] 補填判定取得 - DR115 = '1.31%'
● 補填処理：101210
　┗ fam8（K115）: 149327.0
　┗ mime(補填) = ROUND(149327.0 * 0.95) → 141861
　┗ 判定セル：N115 = '補填対象'
　┗ 書き込み先：進捗シート『2025年4月』 → fam8 → N137, mime → J137
　┗ 処理結果：OK
● 通常処理：101213
　┗ fam8（AC115）: 92079.0
　┗ mime（AD115）: 90393.0
　┗ 書き込み先：進捗シート『2025年4月』 → fam8 → U137, mime → Q137
　┗ 処理結果：OK
● 通常処理：104358
　┗ fam8（DI115）: 35200.0
　┗ mime（DJ115）: 34854.0
　┗ 書き込み先：進捗シート『2025年4月』 → fam8 → AB137, mime → X137
　┗ 処理結果：OK
● 通常処理：104826
　┗ fam8（DO115）: 11753.0
　┗ mime（DP115）: 11599.0
　┗ 書き込み先：進捗シート『2025年4月』 → fam8 → AI137, mime → AE137
　┗ 処理結果：OK
[INFO] 処理件数：4 件
[INFO] 全処理完了。
--------------------------------------- 
[STEP 02] アップデートとビズコラボ_fam8進捗Report取得(AX-AD) 
--------------------------------------- 
^C==================================================== 
[2025/04/08 19:00:16.19] [INFO] アップデートとビズコラボ_日次処理 開始 
---------------------------------------------------- 
[2025/04/08 19:00:16.19] [INFO] 実行ディレクトリ: D:\rep05\Pythonエンベッダブル検証環境\アップデートとビズコラボ_進捗Report 
[2025/04/08 19:00:16.19] [INFO] 使用するPython: D:\rep05\Pythonエンベッダブル検証環境\Python実行環境\python.exe 
==================================================== 
Python 3.13.2
--------------------------------------- 
[STEP 01] 日時レポート計測値(famとマイム)取得と各ID進捗表に反映 
--------------------------------------- 
[DEBUG] 自動生成された table_config:
  101210: {'report_col': '101210', 'start_cell': 'I3', 'row_range': (128, 173)}
  101213: {'report_col': '101213', 'start_cell': 'P3', 'row_range': (128, 173)}
  104358: {'report_col': '104358', 'start_cell': 'W3', 'row_range': (128, 173)}
  104826: {'report_col': '104826', 'start_cell': 'AD3', 'row_range': (128, 173)}
[INFO] 処理中 → ID: 101210
[DEBUG] fam8取得 - K115 = '149,327'
[DEBUG] mime取得 - L115 = '134,176'
[DEBUG] 補填判定取得 - N115 = '10.15%'
[INFO] 処理中 → ID: 101213
[DEBUG] fam8取得 - AC115 = '92,079'
[DEBUG] mime取得 - AD115 = '90,393'
[DEBUG] 補填判定取得 - AF115 = '1.83%'
[INFO] 処理中 → ID: 104358
[DEBUG] fam8取得 - DI115 = '35,200'
[DEBUG] mime取得 - DJ115 = '34854'
[DEBUG] 補填判定取得 - DL115 = '0.98%'
[INFO] 処理中 → ID: 104826
[DEBUG] fam8取得 - DO115 = '11,753'
[DEBUG] mime取得 - DP115 = '11599'
[DEBUG] 補填判定取得 - DR115 = '1.31%'
● 補填処理：101210
　┗ fam8（K115）: 149327.0
　┗ mime(補填) = ROUND(149327.0 * 0.95) → 141861
　┗ 判定セル：N115 = '補填対象'
　┗ 書き込み先：進捗シート『2025年4月』 → fam8 → N136, mime → J136
　┗ 処理結果：OK
● 通常処理：101213
　┗ fam8（AC115）: 92079.0
　┗ mime（AD115）: 90393.0
　┗ 書き込み先：進捗シート『2025年4月』 → fam8 → U138, mime → Q138
　┗ 処理結果：OK
● 通常処理：104358
　┗ fam8（DI115）: 35200.0
　┗ mime（DJ115）: 34854.0
　┗ 書き込み先：進捗シート『2025年4月』 → fam8 → AB138, mime → X138
　┗ 処理結果：OK
● 通常処理：104826
　┗ fam8（DO115）: 11753.0
　┗ mime（DP115）: 11599.0
　┗ 書き込み先：進捗シート『2025年4月』 → fam8 → AI138, mime → AE138
　┗ 処理結果：OK
[INFO] 処理件数：4 件
[INFO] 全処理完了。
--------------------------------------- 
[STEP 02] アップデートとビズコラボ_fam8進捗Report取得(AX-AD) 
--------------------------------------- 
[INFO] WebDriver を起動します
[INFO] WebDriver の起動完了
[INFO] ログイン処理を開始します
[INFO] ログイン完了
[INFO] レポートメニューをクリック
[INFO] 表示モード切り替えをクリック
[INFO] キーワード『AX-AD』を入力
[INFO] 表示項目設定をクリック
[INFO] 表示項目チェックを開始
[INFO] [CHECKED] メディアオーナーID → チェックON
[INFO] [CHECKED] メディアオーナー名 → チェックON
[INFO] [CHECKED] メディアID → チェックON
[INFO] [CHECKED] CPC(グロス) → チェックON
[INFO] [CHECKED] CPA(グロス) → チェックON
[INFO] [CHECKED] eCPM(グロス) → チェックON
[INFO] [CHECKED] メディア名 → チェックON
[INFO] [CHECKED] 特別保証期間(From) → チェックON
[INFO] 検索ボタンをクリック
[INFO] 検索結果を待機中（5秒）
[INFO] CSVダウンロードボタンをクリック
[SUCCESS] CSVダウンロードを実行しました
[WARNING] 同名のCSVが既に存在 → 上書き: AX-ADレポート_20250407.csv
[INFO] CSVファイルを AX-ADレポート_20250407.csv にリネーム完了
[INFO] スクリプト正常終了
--------------------------------------- 
[STEP 03] CSVを集計用シート（AX-AD）へアップロード 
--------------------------------------- 
[INFO] アップロード処理を開始
[CHECK] CSV パス: アップデート×ビズコラボ日次CSV\20250407\AX-ADレポート_20250407.csv
[CHECK] 存在: True
[DEBUG] 読込CSV: アップデート×ビズコラボ日次CSV\20250407\AX-ADレポート_20250407.csv
[INFO] アップロード完了 → A2:Y71
[INFO] 全処理完了
--------------------------------------- 
[STEP 04] 今月シートのAX-AD表に関数挿入と値のみ変換 
--------------------------------------- 
[INFO] 処理対象シート：2025年4月
[INFO] 処理対象行：今日=95 / 昨日=94

[INFO] 処理対象行
(今日)2025/04/08→95行目に関数挿入
(昨日)2025/04/07→94行目に値のみ変換

[警告] AY86 は空
[警告] BF86 は空
[警告] BM86 は空
[警告] BT86 は空
[INFO] 取得後のIDセルの値（数値変換済）: [99889.0, 101563.0, 102920.0, 105377.0, 105376.0, 105375.0, 0, 0, 0, 0]
[INFO] 数式に使用する ID（整数化済）: 99889
[INFO] 数式挿入の範囲: 行 95, 列 9 - 13
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(99889, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(J95=0, K85=""), 0, J95/1000*K85)', "=IFERROR(VLOOKUP(99889, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(K95=0, 0, K95-L95)']
[INFO] 数式に使用する ID（整数化済）: 101563
[INFO] 数式挿入の範囲: 行 95, 列 16 - 20
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(101563, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(Q95=0, R85=""), 0, Q95/1000*R85)', "=IFERROR(VLOOKUP(101563, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(R95=0, 0, R95-S95)']
[INFO] 数式に使用する ID（整数化済）: 102920
[INFO] 数式挿入の範囲: 行 95, 列 23 - 27
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(102920, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(X95=0, Y85=""), 0, X95/1000*Y85)', "=IFERROR(VLOOKUP(102920, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(Y95=0, 0, Y95-Z95)']
[INFO] 数式に使用する ID（整数化済）: 105377
[INFO] 数式挿入の範囲: 行 95, 列 30 - 34
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(105377, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(AE95=0, AF85=""), 0, AE95/1000*AF85)', "=IFERROR(VLOOKUP(105377, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(AF95=0, 0, AF95-AG95)']
[INFO] 数式に使用する ID（整数化済）: 105376
[INFO] 数式挿入の範囲: 行 95, 列 37 - 41
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(105376, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(AL95=0, AM85=""), 0, AL95/1000*AM85)', "=IFERROR(VLOOKUP(105376, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(AM95=0, 0, AM95-AN95)']
[INFO] 数式に使用する ID（整数化済）: 105375
[INFO] 数式挿入の範囲: 行 95, 列 44 - 48
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(105375, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(AS95=0, AT85=""), 0, AS95/1000*AT85)', "=IFERROR(VLOOKUP(105375, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(AT95=0, 0, AT95-AU95)']
[INFO] 数式に使用する ID（整数化済）: 0
[INFO] 数式挿入の範囲: 行 95, 列 51 - 55
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(0, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(AZ95=0, BA85=""), 0, AZ95/1000*BA85)', "=IFERROR(VLOOKUP(0, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(BA95=0, 0, BA95-BB95)']
[INFO] 数式に使用する ID（整数化済）: 0
[INFO] 数式挿入の範囲: 行 95, 列 58 - 62
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(0, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(BG95=0, BH85=""), 0, BG95/1000*BH85)', "=IFERROR(VLOOKUP(0, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(BH95=0, 0, BH95-BI95)']
[INFO] 数式に使用する ID（整数化済）: 0
[INFO] 数式挿入の範囲: 行 95, 列 65 - 69
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(0, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(BN95=0, BO85=""), 0, BN95/1000*BO85)', "=IFERROR(VLOOKUP(0, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(BO95=0, 0, BO95-BP95)']
[INFO] 数式に使用する ID（整数化済）: 0
[INFO] 数式挿入の範囲: 行 95, 列 72 - 76
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(0, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(BU95=0, BV85=""), 0, BU95/1000*BV85)', "=IFERROR(VLOOKUP(0, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(BV95=0, 0, BV95-BW95)']
[INFO] 関数挿入 batchUpdate 成功：10 リクエスト実行済
[INFO] 評価結果を取得 → 範囲: J95:M95 / 値: ['0', '0', '0', '0']
[INFO] 評価結果を取得 → 範囲: Q95:T95 / 値: ['0', '0', '0', '0']
[INFO] 評価結果を取得 → 範囲: X95:AA95 / 値: ['0', '0', '0', '0']
[INFO] 評価結果を取得 → 範囲: AE95:AH95 / 値: ['84179', '656.5962', '462.9845', '193.6117']
[INFO] 評価結果を取得 → 範囲: AL95:AO95 / 値: ['210803', '948.6135', '632.409', '316.2045']
[INFO] 評価結果を取得 → 範囲: AS95:AV95 / 値: ['0', '0', '0', '0']
[INFO] 評価結果を取得 → 範囲: AZ95:BC95 / 値: ['0', '0', '0', '0']
[INFO] 評価結果を取得 → 範囲: BG95:BJ95 / 値: ['0', '0', '0', '0']
[INFO] 評価結果を取得 → 範囲: BN95:BQ95 / 値: ['0', '0', '0', '0']
[INFO] 評価結果を取得 → 範囲: BU95:BX95 / 値: ['0', '0', '0', '0']
[INFO] 値のみ貼付一括完了: 10リクエスト
[INFO] 値のみ貼付一括実行成功: 10 リクエスト
[INFO] 右寄せ一括整形成功: 10 リクエスト
[正常終了] 対象の広告枠IDの表に対して関数の挿入と前日行への値のみ貼付が完了しました
[確認用] 関数を挿入した行（本日）: 95 行目 / 値を貼り付けた行（前日）: 94 行目
==================================================== 
[2025/04/08 19:01:17.99] [INFO] 全処理完了 
==================================================== 

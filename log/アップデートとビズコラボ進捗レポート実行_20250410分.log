==================================================== 
[2025/04/11 13:47:21.26] [INFO] アップデートとビズコラボ_日次処理 開始 
---------------------------------------------------- 
[2025/04/11 13:47:21.26] [INFO] 実行ディレクトリ: C:\Users\rep03\Desktop\Pythonファイル\アップデートとビズコラボ_進捗Report 
[2025/04/11 13:47:21.26] [INFO] 使用するPython: C:\Users\rep03\Desktop\Pythonファイル\Python実行環境\python.exe 
==================================================== 
Python 3.13.2
--------------------------------------- 
[STEP 01] 日時レポート計測値取得と各ID進捗表に反映 
--------------------------------------- 
[DEBUG] 自動生成された table_config:
  101210: {'report_col': '101210', 'start_cell': 'I3', 'row_range': (128, 173)}
  101213: {'report_col': '101213', 'start_cell': 'P3', 'row_range': (128, 173)}
  104358: {'report_col': '104358', 'start_cell': 'W3', 'row_range': (128, 173)}
  104826: {'report_col': '104826', 'start_cell': 'AD3', 'row_range': (128, 173)}
[INFO] 処理中 → ID: 101210
[DEBUG] fam8取得 - K115 = '102,170'
[DEBUG] mime取得 - L115 = '101,012'
[DEBUG] 補填判定取得 - N115 = '1.13%'
[INFO] 処理中 → ID: 101213
[DEBUG] fam8取得 - AC115 = '95,354'
[DEBUG] mime取得 - AD115 = '93,870'
[DEBUG] 補填判定取得 - AF115 = '1.56%'
[INFO] 処理中 → ID: 104358
[DEBUG] fam8取得 - DI115 = '3,530'
[DEBUG] mime取得 - DJ115 = '3345'
[DEBUG] 補填判定取得 - DL115 = '5.24%'
[INFO] 処理中 → ID: 104826
[DEBUG] fam8取得 - DO115 = '13,521'
[DEBUG] mime取得 - DP115 = '12716'
[DEBUG] 補填判定取得 - DR115 = '5.95%'
● 通常処理：101210
　┗ fam8（K115）: 102170.0
　┗ mime（L115）: 101012.0
　┗ 書き込み先：進捗シート『2025年4月』 → fam8 → N139, mime → J139
　┗ 処理結果：OK
● 通常処理：101213
　┗ fam8（AC115）: 95354.0
　┗ mime（AD115）: 93870.0
　┗ 書き込み先：進捗シート『2025年4月』 → fam8 → U139, mime → Q139
　┗ 処理結果：OK
● 補填処理：104358
　┗ fam8（DI115）: 3530.0
　┗ mime(補填) = ROUND(3530.0 * 0.95) → 3354
　┗ 判定セル：DL115 = '補填対象'
　┗ 書き込み先：進捗シート『2025年4月』 → fam8 → AB139, mime → X139
　┗ 処理結果：OK
● 補填処理：104826
　┗ fam8（DO115）: 13521.0
　┗ mime(補填) = ROUND(13521.0 * 0.95) → 12845
　┗ 判定セル：DR115 = '補填対象'
　┗ 書き込み先：進捗シート『2025年4月』 → fam8 → AI139, mime → AE139
　┗ 処理結果：OK
[INFO] 処理件数：4 件
[INFO] 全処理完了。
--------------------------------------- 
[STEP 02] アップデートとビズコラボ_fam8進捗Report取得(AX-AD) 
--------------------------------------- 
[INFO] WebDriver を起動します
[INFO] WebDriver の起動完了
[INFO] ログイン処理を開始します
[INFO] ログイン完了
[INFO] レポートメニューをクリック
[INFO] 表示モード切り替えをクリック
[INFO] キーワード『AX-AD』を入力
[INFO] 表示項目設定をクリック
[INFO] 表示項目チェックを開始
[INFO] [CHECKED] メディアオーナーID → チェックON
[INFO] [CHECKED] メディアオーナー名 → チェックON
[INFO] [CHECKED] メディアID → チェックON
[INFO] [CHECKED] CPC(グロス) → チェックON
[INFO] [CHECKED] CPA(グロス) → チェックON
[INFO] [CHECKED] eCPM(グロス) → チェックON
[INFO] [CHECKED] メディア名 → チェックON
[INFO] [CHECKED] 特別保証期間(From) → チェックON
[INFO] 検索ボタンをクリック
[INFO] 検索結果を待機中（5秒）
[INFO] CSVダウンロードボタンをクリック
[SUCCESS] CSVダウンロードを実行しました
[WARNING] 同名のCSVが既に存在 → 上書き: AX-ADレポート_20250410.csv
[INFO] CSVファイルを AX-ADレポート_20250410.csv にリネーム完了
[INFO] スクリプト正常終了
--------------------------------------- 
[STEP 03] CSVを集計用シート（AX-AD）へアップロード 
--------------------------------------- 
[INFO] アップロード処理を開始
[CHECK] CSV パス: アップデート×ビズコラボ日次CSV\20250410\AX-ADレポート_20250410.csv
[CHECK] 存在: True
[DEBUG] 読込CSV: アップデート×ビズコラボ日次CSV\20250410\AX-ADレポート_20250410.csv
[INFO] アップロード完了 → A2:Y71
[INFO] 全処理完了
--------------------------------------- 
[STEP 04] 今月シートのAX-AD表に関数挿入と値のみ変換 
--------------------------------------- 
[INFO] 処理対象シート：2025年4月
[INFO] 処理対象行：今日=98 / 昨日=97

[INFO] 処理対象行
(今日)2025/04/11→98行目に関数挿入
(昨日)2025/04/10→97行目に値のみ変換

[警告] AY86 は空
[警告] BF86 は空
[警告] BM86 は空
[警告] BT86 は空
[INFO] 取得後のIDセルの値（数値変換済）: [99889.0, 101563.0, 102920.0, 105377.0, 105376.0, 105375.0, 0, 0, 0, 0]
[INFO] 数式に使用する ID（整数化済）: 99889
[INFO] 数式挿入の範囲: 行 98, 列 9 - 13
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(99889, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(J98=0, K85=""), 0, J98/1000*K85)', "=IFERROR(VLOOKUP(99889, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(K98=0, 0, K98-L98)']
[INFO] 数式に使用する ID（整数化済）: 101563
[INFO] 数式挿入の範囲: 行 98, 列 16 - 20
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(101563, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(Q98=0, R85=""), 0, Q98/1000*R85)', "=IFERROR(VLOOKUP(101563, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(R98=0, 0, R98-S98)']
[INFO] 数式に使用する ID（整数化済）: 102920
[INFO] 数式挿入の範囲: 行 98, 列 23 - 27
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(102920, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(X98=0, Y85=""), 0, X98/1000*Y85)', "=IFERROR(VLOOKUP(102920, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(Y98=0, 0, Y98-Z98)']
[INFO] 数式に使用する ID（整数化済）: 105377
[INFO] 数式挿入の範囲: 行 98, 列 30 - 34
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(105377, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(AE98=0, AF85=""), 0, AE98/1000*AF85)', "=IFERROR(VLOOKUP(105377, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(AF98=0, 0, AF98-AG98)']
[INFO] 数式に使用する ID（整数化済）: 105376
[INFO] 数式挿入の範囲: 行 98, 列 37 - 41
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(105376, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(AL98=0, AM85=""), 0, AL98/1000*AM85)', "=IFERROR(VLOOKUP(105376, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(AM98=0, 0, AM98-AN98)']
[INFO] 数式に使用する ID（整数化済）: 105375
[INFO] 数式挿入の範囲: 行 98, 列 44 - 48
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(105375, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(AS98=0, AT85=""), 0, AS98/1000*AT85)', "=IFERROR(VLOOKUP(105375, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(AT98=0, 0, AT98-AU98)']
[INFO] 数式に使用する ID（整数化済）: 0
[INFO] 数式挿入の範囲: 行 98, 列 51 - 55
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(0, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(AZ98=0, BA85=""), 0, AZ98/1000*BA85)', "=IFERROR(VLOOKUP(0, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(BA98=0, 0, BA98-BB98)']
[INFO] 数式に使用する ID（整数化済）: 0
[INFO] 数式挿入の範囲: 行 98, 列 58 - 62
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(0, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(BG98=0, BH85=""), 0, BG98/1000*BH85)', "=IFERROR(VLOOKUP(0, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(BH98=0, 0, BH98-BI98)']
[INFO] 数式に使用する ID（整数化済）: 0
[INFO] 数式挿入の範囲: 行 98, 列 65 - 69
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(0, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(BN98=0, BO85=""), 0, BN98/1000*BO85)', "=IFERROR(VLOOKUP(0, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(BO98=0, 0, BO98-BP98)']
[INFO] 数式に使用する ID（整数化済）: 0
[INFO] 数式挿入の範囲: 行 98, 列 72 - 76
[INFO] 挿入した関数: ["=IFERROR(VLOOKUP(0, '集計用シート（AX-AD）'!$C:$L, 10, FALSE), 0)", '=IF(OR(BU98=0, BV85=""), 0, BU98/1000*BV85)', "=IFERROR(VLOOKUP(0, '集計用シート（AX-AD）'!$C:$R, 16, FALSE), 0)", '=IF(BV98=0, 0, BV98-BW98)']
[INFO] 関数挿入 batchUpdate 成功：10 リクエスト実行済
[INFO] 評価結果を取得 → 範囲: J98:M98 / 値: ['0', '0', '0', '0']
[INFO] 評価結果を取得 → 範囲: Q98:T98 / 値: ['0', '0', '0', '0']
[INFO] 評価結果を取得 → 範囲: X98:AA98 / 値: ['0', '0', '0', '0']
[INFO] 評価結果を取得 → 範囲: AE98:AH98 / 値: ['55850', '435.63', '307.175', '128.455']
[INFO] 評価結果を取得 → 範囲: AL98:AO98 / 値: ['56887', '255.9915', '170.661', '85.3305']
[INFO] 評価結果を取得 → 範囲: AS98:AV98 / 値: ['0', '0', '0', '0']
[INFO] 評価結果を取得 → 範囲: AZ98:BC98 / 値: ['0', '0', '0', '0']
[INFO] 評価結果を取得 → 範囲: BG98:BJ98 / 値: ['0', '0', '0', '0']
[INFO] 評価結果を取得 → 範囲: BN98:BQ98 / 値: ['0', '0', '0', '0']
[INFO] 評価結果を取得 → 範囲: BU98:BX98 / 値: ['0', '0', '0', '0']
[INFO] 値のみ貼付一括完了: 10リクエスト
[INFO] 値のみ貼付一括実行成功: 10 リクエスト
[INFO] 右寄せ一括整形成功: 10 リクエスト
[正常終了] 対象の広告枠IDの表に対して関数の挿入と前日行への値のみ貼付が完了しました
[確認用] 関数を挿入した行（本日）: 98 行目 / 値を貼り付けた行（前日）: 97 行目
--------------------------------------- 
[STEP 05] マイム表_金額計算結果のみ記入 
--------------------------------------- 
[2025-04-11 13:48:24][INFO] 認証成功: GoogleシートAPI接続完了
[2025-04-11 13:48:24][INFO] =========== 処理開始 ===========
[2025-04-11 13:48:27][INFO] 最新月シート: 2025年4月
[2025-04-11 13:48:27][INFO] 対象表セル番地一覧: ['I128', 'P128', 'W128', 'AD128']
[2025-04-11 13:48:27][INFO] 処理開始: I128 (広告ID=101210)
[2025-04-11 13:48:29][INFO] 広告ID 101210 のCPM: 新セル K127 から 30.0円 を取得
[2025-04-11 13:48:30][INFO] 広告ID 101210 のメディア単価: セル N128 から 20.0円 を取得
[2025-04-11 13:48:30][INFO] I128(101210) 行139: imp=101012.0, fam8=102170.0, cpm=30.0, media_unit=20.0
[2025-04-11 13:48:30][INFO] [CALC] I128(101210): 売上=\xa53,030, 支払=\xa52,043, 利益=\xa5987
[2025-04-11 13:48:30][INFO] [WRITE] I128(101210) → 139行: ('\xa53,030', '\xa52,043', '\xa5987')
[2025-04-11 13:48:30][INFO] 処理開始: P128 (広告ID=101213)
[2025-04-11 13:48:31][INFO] 広告ID 101213 のCPM: 新セル R127 から 30.0円 を取得
[2025-04-11 13:48:32][INFO] 広告ID 101213 のメディア単価: セル U128 から 18.0円 を取得
[2025-04-11 13:48:32][INFO] P128(101213) 行139: imp=93870.0, fam8=95354.0, cpm=30.0, media_unit=18.0
[2025-04-11 13:48:32][INFO] [CALC] P128(101213): 売上=\xa52,816, 支払=\xa51,716, 利益=\xa51,100
[2025-04-11 13:48:32][INFO] [WRITE] P128(101213) → 139行: ('\xa52,816', '\xa51,716', '\xa51,100')
[2025-04-11 13:48:32][INFO] 処理開始: W128 (広告ID=104358)
[2025-04-11 13:48:34][INFO] 広告ID 104358 のCPM: 新セル Y127 から 33.0円 を取得
[2025-04-11 13:48:35][INFO] 広告ID 104358 のメディア単価: セル AB128 から 23.1円 を取得
[2025-04-11 13:48:35][INFO] W128(104358) 行139: imp=3354.0, fam8=3530.0, cpm=33.0, media_unit=23.1
[2025-04-11 13:48:35][INFO] [CALC] W128(104358): 売上=\xa5111, 支払=\xa582, 利益=\xa529
[2025-04-11 13:48:35][INFO] [WRITE] W128(104358) → 139行: ('\xa5111', '\xa582', '\xa529')
[2025-04-11 13:48:35][INFO] 処理開始: AD128 (広告ID=104826)
[2025-04-11 13:48:36][INFO] 広告ID 104826 のCPM: 新セル AF127 から 41.8円 を取得
[2025-04-11 13:48:37][INFO] 広告ID 104826 のメディア単価: セル AI128 から 31.4円 を取得
[2025-04-11 13:48:37][INFO] AD128(104826) 行139: imp=12845.0, fam8=13521.0, cpm=41.8, media_unit=31.4
[2025-04-11 13:48:37][INFO] [CALC] AD128(104826): 売上=\xa5537, 支払=\xa5425, 利益=\xa5112
[2025-04-11 13:48:37][INFO] [WRITE] AD128(104826) → 139行: ('\xa5537', '\xa5425', '\xa5112')
[2025-04-11 13:48:38][INFO] 値書き込み完了: 4 件
[2025-04-11 13:48:39][INFO] 整形完了: 4 件
[2025-04-11 13:48:39][INFO] === 計算結果検証 ===
[2025-04-11 13:48:39][INFO] 広告ID: 101210 (I128)
[2025-04-11 13:48:39][INFO]    配信量: 101,012, FAM8計測: 102,170, CPM: 30.0円, メディア単価: 20.0円
[2025-04-11 13:48:39][INFO]    売上計算: 101,012 ÷ 1000 × 30.0 = 3,030円
[2025-04-11 13:48:39][INFO]    支払計算: 102,170 ÷ 1000 × 20.0 = 2,043円
[2025-04-11 13:48:39][INFO]    利益計算: 3,030 - 2,043 = 987円
[2025-04-11 13:48:39][INFO] 
[2025-04-11 13:48:39][INFO] 広告ID: 101213 (P128)
[2025-04-11 13:48:39][INFO]    配信量: 93,870, FAM8計測: 95,354, CPM: 30.0円, メディア単価: 18.0円
[2025-04-11 13:48:39][INFO]    売上計算: 93,870 ÷ 1000 × 30.0 = 2,816円
[2025-04-11 13:48:39][INFO]    支払計算: 95,354 ÷ 1000 × 18.0 = 1,716円
[2025-04-11 13:48:39][INFO]    利益計算: 2,816 - 1,716 = 1,100円
[2025-04-11 13:48:39][INFO] 
[2025-04-11 13:48:39][INFO] 広告ID: 104358 (W128)
[2025-04-11 13:48:39][INFO]    配信量: 3,354, FAM8計測: 3,530, CPM: 33.0円, メディア単価: 23.1円
[2025-04-11 13:48:39][INFO]    売上計算: 3,354 ÷ 1000 × 33.0 = 111円
[2025-04-11 13:48:39][INFO]    支払計算: 3,530 ÷ 1000 × 23.1 = 82円
[2025-04-11 13:48:39][INFO]    利益計算: 111 - 82 = 29円
[2025-04-11 13:48:39][INFO] 
[2025-04-11 13:48:39][INFO] 広告ID: 104826 (AD128)
[2025-04-11 13:48:39][INFO]    配信量: 12,845, FAM8計測: 13,521, CPM: 41.8円, メディア単価: 31.4円
[2025-04-11 13:48:39][INFO]    売上計算: 12,845 ÷ 1000 × 41.8 = 537円
[2025-04-11 13:48:39][INFO]    支払計算: 13,521 ÷ 1000 × 31.4 = 425円
[2025-04-11 13:48:39][INFO]    利益計算: 537 - 425 = 112円
[2025-04-11 13:48:39][INFO] 
[2025-04-11 13:48:39][INFO] =========== 処理完了 ===========
==================================================== 
[2025/04/11 13:48:39.63] [INFO] 全処理完了 
==================================================== 
